version: "3.7"
networks:
    net2:
        driver: overlay
    
services:

    service_1:
        image: amranlab/service_1
        ports:
            - "5000:5000"
        env_file:
            - ./.env
        networks:
            - net2
        deploy:
            replicas: 3
        

    service_2:
        image: amranlab/service_2
        networks:
            - net2
        deploy:
            replicas: 3
        

    service_3:
        image: amranlab/service_3
        networks:
            - net2
        deploy:
            replicas: 3

    service_4:
        image: amranlab/service_4
        networks:
            - net2
        deploy:
            replicas: 1

    service_nginx:
        image: amranlab/nginx:latest
        ports:
            - 80:80
        networks:
            - net2
        depends_on:
            - service_1
            - service_2
            - service_3
            - service_4
        deploy:
            replicas: 3

    



